NODE usages_node
DESCRIPTION >
    Aggregate unique sessions per workspace by hour for usage tracking

SQL >
    SELECT
        toStartOfHour(timestamp) AS date,
        workspace_id,
        uniqStateIf(session_id, type IN ('funnel_enter', 'funnel_viewed')) AS sessions
    FROM events
    GROUP BY date, workspace_id

TYPE MATERIALIZED
DATASOURCE usages_mv
